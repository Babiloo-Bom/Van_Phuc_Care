version: '3.9'

# ============================================
# Van Phuc Care - Development Docker Compose
# Hot reload enabled
# ============================================

services:
  # ============================================
  # Admin Portal (Development)
  # ============================================
  admin-dev:
    build:
      context: ./admin-vpc-v3
      dockerfile: Dockerfile.dev
      args:
        - NODE_ENV=development
    container_name: vpc-admin-dev
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      - ./admin-vpc-v3:/app
      - /app/node_modules
      - /app/.nuxt
      - /app/.output
    environment:
      - NODE_ENV=development
      - NUXT_PUBLIC_API_HOST=http://103.216.119.104:3000
      - NUXT_PUBLIC_API_BASE=http://103.216.119.104:3000/a
      - NUXT_PUBLIC_TINYMCE_KEY=${TINYMCE_KEY}
    networks:
      - vpc-network
    command: npm run dev

  # ============================================
  # CRM Portal (Development)
  # ============================================
  crm-dev:
    build:
      context: ./crm-vpc-v3
      dockerfile: Dockerfile.dev
      args:
        - NODE_ENV=development
    container_name: vpc-crm-dev
    restart: unless-stopped
    ports:
      - "3001:3001"
    volumes:
      - ./crm-vpc-v3:/app
      - /app/node_modules
      - /app/.nuxt
      - /app/.output
    environment:
      - NODE_ENV=development
      - NUXT_PUBLIC_API_HOST=http://103.216.119.104:3000
      - NUXT_PUBLIC_API_BASE=http://103.216.119.104:3000/a
      - NUXT_PUBLIC_TINYMCE_KEY=${TINYMCE_KEY}
    networks:
      - vpc-network
    command: npm run dev

  # ============================================
  # E-Learning Portal (Development)
  # ============================================
  elearning-dev:
    build:
      context: ./elerning-vpc-v3
      dockerfile: Dockerfile.dev
      args:
        - NODE_ENV=development
    container_name: vpc-elearning-dev
    restart: unless-stopped
    ports:
      - "3002:3002"
    volumes:
      - ./elerning-vpc-v3:/app
      - /app/node_modules
      - /app/.nuxt
      - /app/.output
    environment:
      - NODE_ENV=development
      - NUXT_PUBLIC_API_HOST=http://103.216.119.104:3000
      - NUXT_PUBLIC_API_BASE=http://103.216.119.104:3000/u
      - NUXT_PUBLIC_TINYMCE_KEY=${TINYMCE_KEY}
    networks:
      - vpc-network
    command: npm run dev

networks:
  vpc-network:
    driver: bridge
    name: van-phuc-care-network-dev

